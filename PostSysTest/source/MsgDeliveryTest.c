
/******************************************************************************
*
*   FILE
*   ----
*   MsgDeliveryTest.c
*
*   History
*   -------
*   2018-11-17   File created
*
*******************************************************************************
*
*   This file is generated by the 'acplt_builder' command
*
******************************************************************************/


#ifndef OV_COMPILE_LIBRARY_PostSysTest
#define OV_COMPILE_LIBRARY_PostSysTest
#endif


#include "PostSysTest.h"
#include "libov/ov_macros.h"
#include "PostSys.h"

#include "unity.h"
#include "unity_fixture.h"

#include "ovunity.h"
#include "ovunity_helper.h"

#include "CException.h"

OV_INSTPTR_ovunity_main gpinst;

OV_TIME *gpltc;

TEST_GROUP( MsgDelivery);

TEST_SETUP( MsgDelivery) {
	ov_memstack_lock();
}

TEST_TEAR_DOWN( MsgDelivery) {
	ov_memstack_unlock();
}

TEST( MsgDelivery, MsgDelivery_default) {
	OV_RESULT result = OV_ERR_OK;
	OV_INSTPTR_PostSys_MsgDelivery pobj = NULL;
	OV_STRING case_name = "case_self2";
	OV_STRING case_path = ovunity_getCasePath(gpinst, case_name);

	/* create case */
	OV_INSTPTR_ovunity_ovCase pcase = ovunity_createCase(gpinst, case_name);
	if(!pcase) Throw(OV_ERR_GENERIC);

	ovunity_ovCase_build1(pcase);
	pobj = Ov_StaticPtrCast(PostSys_MsgDelivery, ovunity_ovCase_getObjPath(pcase));

	result = ovunity_compareIstSoll(pcase);

	TEST_ASSERT_EQUAL(result, 0);
}

TEST_GROUP_RUNNER( MsgDelivery) {
	RUN_TEST_CASE(MsgDelivery, MsgDelivery_default);
}

static void RunAllTests(void) {
	RUN_TEST_GROUP(MsgDelivery);
}

OV_DLLFNCEXPORT void PostSysTest_MsgDeliveryTest_typemethod(
	OV_INSTPTR_fb_functionblock	pfb,
	OV_TIME						*pltc
) {
    /*    
    *   local variables
    */
	OV_INSTPTR_PostSysTest_MsgDeliveryTest pinst = Ov_StaticPtrCast(
		PostSysTest_MsgDeliveryTest, pfb);
	gpinst = Ov_StaticPtrCast(ovunity_main, pfb);
	//	gpobj = &Ov_StaticPtrCast(PostSysTest_MsgDeliveryTest,gpinst)->p_obj;
	gpltc = pltc;

	//todo
	char* ahome = getenv("ACPLT_HOME");
	ov_string_print(&pinst->v_sysPath, "%s/dev/PostSysTest/test/MsgDeliveryTest",
		ahome);

	const char* argv[] = { "MsgDelivery", "-v" };
	CEXCEPTION_T e;
	Try
	{
		UnityMain(2, argv, RunAllTests);
	}
	Catch(e)
	{
		ov_logfile_error("MsgDeliveryTest fail");
	}
    return;
}

