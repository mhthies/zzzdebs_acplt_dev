/******************************************************************************
 *
 *   FILE
 *   ----
 *   dijkstraTest.c
 *
 *   History
 *   -------
 *   2018-07-16   File created
 *
 *******************************************************************************
 *
 *   This file is generated by the 'acplt_builder' command
 *
 ******************************************************************************/

#ifndef OV_COMPILE_LIBRARY_TGraphTest
#define OV_COMPILE_LIBRARY_TGraphTest
#endif

#include "TGraphTest.h"
#include "libov/ov_macros.h"
#include "dijkstra.h"
#include "CException.h"

#include "unity.h"
#include "unity_fixture.h"

#include "ovunity.h"
#include "ovunity_helper.h"


OV_INSTPTR_ovunity_main gpinst;
OV_INSTPTR_TGraph_graph gpobj;
OV_TIME *gpltc;

TEST_GROUP( dijkstra);

TEST_SETUP( dijkstra) {
	ov_memstack_lock();
	//This is run before EACH TEST
//	ov_string_setvalue(&gpinst->v_start, "PE004");
//	ov_string_set_vecvalue_one(&gpinst->v_recipe, 1, "PE005");
//	gpinst->v_EN = 0;
}

TEST_TEAR_DOWN( dijkstra) {
	ov_memstack_unlock();
}

TEST( dijkstra, dijkstra_default) {
	OV_STRING case_path = ovunity_getCasePath(gpinst,"case_default");
	ovunity_loadEnv(gpinst, "default.json", case_path);
//	gpinst
	OV_STRING path = NULL;
	ov_string_print(&path, "%s.%s", case_path, "Nodes/PE025_0", 2);
	OV_INSTPTR_TGraph_Node source = (void*) ov_path_getobjectpointer(
		path, 2);
	ov_string_print(&path, "%s.%s", case_path, "Nodes/PE021_0", 2);
	OV_INSTPTR_TGraph_Node target = (void*) ov_path_getobjectpointer(
		path, 2);
	ov_string_setvalue(&case_path, NULL);
	ov_string_setvalue(&path, NULL);
	dijkstra_get_path(source, target);
}

TEST_GROUP_RUNNER( dijkstra) {
	RUN_TEST_CASE(dijkstra, dijkstra_default);
}

static void RunAllTests(void) {
	RUN_TEST_GROUP(dijkstra);
}

OV_DLLFNCEXPORT void TGraphTest_dijkstraTest_typemethod(
		OV_INSTPTR_fb_functionblock pfb, OV_TIME *pltc) {
	/*
	 *   local variables
	 */
	gpinst = Ov_StaticPtrCast(ovunity_main, pfb);
	gpobj = &(Ov_StaticPtrCast(TGraphTest_dijkstraTest, gpinst)->p_obj);
	gpltc = pltc;

	const char* argv[] = { "dijkstra", "-v" };
	CEXCEPTION_T e;
	Try
			{
				UnityMain(2, argv, RunAllTests);
			}
				Catch(e)
	{
		ov_logfile_error("dijkstraTest catch");
	}
	return;
}

